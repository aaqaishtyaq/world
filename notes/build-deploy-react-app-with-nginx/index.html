<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Aaqa Ishtyaq, Ramblings on programming, tech and life." name=description><title>Aaqa Ishtyaq</title><meta content="Deploy a React app with sass using Nginx" name=title><meta content="Aaqa Ishtyaq" property=og:site_name><meta content=article property=og:type><meta content="Deploy a React app with sass using Nginx" property=og:title><meta property=og:description><meta content=https://aaqa.dev/https://aaqa.dev/notes/build-deploy-react-app-with-nginx/ property=og:url><meta content=2018-06-02 property=article:published_time><meta content=2018-06-02 property=article:modified_time><meta content=summary name=twitter:card><meta content="Deploy a React app with sass using Nginx" name=twitter:title><meta name=twitter:description><meta content=https://aaqa.dev/https://aaqa.dev/notes/build-deploy-react-app-with-nginx/ name=twitter:url><meta content=@aaqaishtyaq name=twitter:site><meta content="Written by" name=twitter:label1><meta content="Aaqa Ishtyaq" name=twitter:data1><meta content=@aaqaishtyaq name=twitter:creator><link href=https://aaqa.dev/theme.css rel=stylesheet><link href="https://aaqa.dev/ rss.xml" rel=alternate title=RSS type=application/rss+xml><script async data-token=aa8756e9-c3cd-41e6-8a91-e3c8203201db src=https://beamanalytics.b-cdn.net/beam.min.js></script><link as=font crossorigin href=/fonts/iosevka-regular.woff2 rel=preload type=font/woff2><body><div class=content><header><div class=header-left><a class=logo href=https://aaqa.dev/>Aaqa Ishtyaq</a></div><div class=header-right><nav itemscope itemtype=http://schema.org/SiteNavigationElement><ul><li class=nav><a href=https://aaqa.dev/notes/ itemprop=url> <span itemprop=name>Notes </span> </a><li class=nav><a href=https://aaqa.dev/reading/ itemprop=url> <span itemprop=name>Reading </span> </a><li class=nav><a href=https://aaqa.dev/travel/ itemprop=url> <span itemprop=name>Travel </span> </a><li class=nav><a href=https://aaqa.dev/tils/ itemprop=url> <span itemprop=name>TIL </span> </a><li class=nav><a href=https://aaqa.dev/uses/ itemprop=url> <span itemprop=name>Uses </span> </a><li class=nav><a href=https://aaqa.dev/contact/ itemprop=url> <span itemprop=name>Contact </span> </a><li class=nav><a href=/rss.xml itemprop=url> <span itemprop=name>Feed</span> </a></ul></nav></div></header><main><article itemscope itemtype=http://schema.org/BlogPosting><div itemprop=headline><h1>Deploy a React app with sass using Nginx</h1><div class=border></div><div class=page-meta><time datetime=" 2018-06-02" class=date itemprop=datePublished> 02 Jun 2018 </time><div class=reading-time><div>2655 words, 13 minutes to read</div></div></div></div><div itemprop=articleBody><p>A couple of days ago (at the time of writing), I started my newest side project. It's a portfolio showcasing my (very very very) amateur photography. It's written in React.js with Sass and I have to say it was extremely enjoyable to work on. Unsurprisingly though, I ran into some issues while deploying to production, which after a lot of head banging against every possible flat surface I could find, I managed to sort. So this post will be about how to make React.js work with sass in production and how to serve the project using Nginx as a front end web server.<p>We'll be using the official starter kit / CLI tool provided by the facebook team called <code>create-react-app</code>.<p>You can install it by running the following command:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">npm</span></span><span class="z-meta z-function-call z-arguments z-shell"> install<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>g</span> create-react-app</span>
</span></code></pre><h2 id=adding-sass-to-a-react-project>Adding Sass to a React project</h2><p>Including sass in a React app can be done in two ways: You can either eject the project and manually modify the webpack config files or you can follow the procedure in the <a rel="noopener nofollow noreferrer" href=https://github.com/facebookincubator/create-react-app/#getting-started target=_blank>official docs</a>. I've personally chosen to go with the first approach. You can just follow the steps in this <a rel="noopener nofollow noreferrer" href=https://medium.com/@Connorelsea/using-sass-with-create-react-app-7125d6913760 target=_blank>tutorial</a> to get up and running.<p><em>Note: If you went with the second approach, you can just skip the following and directly jump to the next section</em><p>Once you've done that, open the config/webpack.config.prod.js file, locate the <code>rules</code> section under <code>module.exports</code> and add the following snippet to it.<pre class="language-javascript z-code" data-lang=javascript><code class=language-javascript data-lang=javascript><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">    <span class="z-entity z-name z-label z-ts">test</span><span class="z-punctuation z-separator z-label z-ts">:</span><span class="z-string z-regexp z-ts"> <span class="z-punctuation z-definition z-string z-begin z-ts">/</span><span class="z-constant z-character z-escape z-backslash z-regexp">\.</span>sass<span class="z-keyword z-control z-anchor z-regexp">$</span><span class="z-punctuation z-definition z-string z-end z-ts">/</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">    <span class="z-entity z-name z-label z-ts">use</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">ExtractTextPlugin</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">extract</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">fallback</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">require</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-promise z-ts">resolve</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>style-loader<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">use</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-meta z-array z-literal z-ts"> <span class="z-meta z-brace z-square z-ts">[</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">require</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-promise z-ts">resolve</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>css-loader<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">require</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-promise z-ts">resolve</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>sass-loader<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-square z-ts">]</span></span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts">    </span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">    <span class="z-entity z-name z-label z-ts">include</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-object z-ts">paths</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">appSrc</span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></code></pre><p>This config will be executed when you call <code>npm run build</code>. If you don't do this, you'll end up with an empty css file.<h2 id=important-note>Important note</h2><p>Before building the project for the first time, we must first unregister the service worker. Doing this will ensure that the static assets aren't cached by the client's browsers. It's important because if you skip this step, any subsequent change / build you'll deploy won't necessarily be reflected right away client side. (I'm not knowledgable enough on service workers to provide details on this behaviour, but it's something to note. If you really need service workers in your project, you might want to explore other solutions to avoid asset caching).<p>Your index.js file should now look something like this:<pre class="language-javascript z-code" data-lang=javascript><code class=language-javascript data-lang=javascript><span class="z-source z-ts"><span class="z-meta z-import z-ts"><span class="z-keyword z-control z-import z-ts">import</span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-variable z-other z-readwrite z-alias z-ts">unregister</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span> <span class="z-keyword z-control z-from z-ts">from</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>./registerServiceWorker<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span>
</span><span class="z-source z-ts"><span class="z-meta z-import z-ts"><span class="z-keyword z-control z-import z-ts">import</span> <span class="z-variable z-other z-readwrite z-alias z-ts">App</span> <span class="z-keyword z-control z-from z-ts">from</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>./App<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">ReactDOM</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">render</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-cast z-expr z-ts"><span class="z-meta z-brace z-angle z-ts"><</span><span class="z-entity z-name z-type z-ts">App</span> /<span class="z-meta z-brace z-angle z-ts">></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-variable z-dom z-ts">document</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-dom z-ts">getElementById</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>root<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">unregister</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span>
</span></code></pre><h2 id=building-the-project>Building the project</h2><p>This is the part where we actually build our project. By building I mean compiling all React files and their related dependencies, transpiling them into vanilla Javascript, compiling sass files into css, minifying them etc ... To do this, we can simply run <code>npm run build</code> and voila ! You should have a brand new <code>build</code> folder in your project.<h2 id=creating-our-deploy-script>Creating our deploy script</h2><p>Your app is now compiled and ready to be served. Now is a good time to start thinking about deployment strategies. In this basic scenario (and quite frankly, most scenraios), you really just want to upload the build folder to a remote server and have it accessible as a static site.<p>You can use ftp to transfer the files and it would be perfectly acceptable, but it's not the most flexible solution. The alternative is to use a CLI utility called <code>rsync</code> (which is available on mac and linux, not sure about windows). With rsync, you can synchronise files and folders within the same computer or across machines you have ssh access to.<p>Here's the command we would run to synchronise the build folder to a server on the internet:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Asssuming we're inside the project folder</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">rsync</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>avP</span> build/ username@remote_ip:/destination/path</span>
</span></code></pre><p>Let's break down this command:<p><code>-a</code> means archive, which is a shortcut for multiple switches. It recursively syncs all files and subfolders within <code>build</code> to the destnation path, keeping the modification dates, permissions and other metadata unchanged.<p><code>-v</code> means verbose. It just outputs the steps to the screen so you can see what happens in real time.<p><code>-P</code> stands for progress. This is particularly useful in this case because you rely on a network connection to sync the files. Using this option will display a progress bar for each file in the queue.<p>But you don't want to keep doing all of that every time we want to push now do you ?<p>Thankfully, you can use create a bash script to automate this process a litte bit. Here's how mine looks like:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">!/bin/sh</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>[log] - Merging branch to master<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">git</span></span><span class="z-meta z-function-call z-arguments z-shell"> checkout master</span> <span class="z-keyword z-operator z-logical z-and z-shell">&&</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">git</span></span><span class="z-meta z-function-call z-arguments z-shell"> merge develop</span> <span class="z-keyword z-operator z-logical z-and z-shell">&&</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">git</span></span><span class="z-meta z-function-call z-arguments z-shell"> push origin master</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>[log] - Merge completed<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>[log] - Compiling project to build folder ...<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">npm</span></span><span class="z-meta z-function-call z-arguments z-shell"> run build</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>[log] - Build process done<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>[log] - Deploying files to server<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">rsync</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>avP</span> build/ user@host:/destination/path</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>[log] - Deployment completed<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>[log] - Switching to develop<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">git</span></span><span class="z-meta z-function-call z-arguments z-shell"> checkout develop</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>[log] - Done!<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span></code></pre><p>Again, let's walk through that script section by section:<ol><li>I checkout to master, merge develop and push. This ensures that my master branch is always up to date with the latest version of my working codebase.<li>I execute <code>npm run build</code> which, as previously explained, will create the build directory with our compiled, ready to be deployed files.<li>I use rsync to copy over the contents of the build folder to the destination path in the remote machine I administer. (notice the trailing slash after build/, this tells rsync to copy the contents of the folder and not the folder itself).<li>I switch the current working branch back to develop so that I can start developing without accidentally altering the state of <code>master</code>.</ol><p>Obviously this is very basic and in a more complex project, you'd have to run unit tests and do other things your project requires.<p>Finally, you need to give executable permissions to the file by running:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> chmod +x deploy.sh</span>
</span></code></pre><p>Now all you have to do when you want to deploy your project to production is run<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">./deploy.sh</span></span>
</span></code></pre><h2 id=serving-our-site-with-nginx>Serving our site with Nginx</h2><p><em>Note: this assumes your server is running ubuntu or any other debian based distro</em><p>Ok, so if you've followed the steps correctly, you should have your project files uploaded to your remote server. Now we need to use Nginx to make the site accessible to the internet.<p>First, create a new config file inside <code>/etc/nginx/sites-available</code>.<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-cd z-shell">cd</span></span><span class="z-meta z-function-call z-arguments z-shell"> /etc/nginx/sites-available</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">touch</span></span><span class="z-meta z-function-call z-arguments z-shell"> mywebsiteconfig <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> File extension is not required in this case</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span></code></pre><p>Next step is to edit the file using either vim or nano (sudo privileges may be required).<pre class="language-conf z-code" data-lang=conf><code class=language-conf data-lang=conf><span class="z-source z-genconfig"><span class="z-storage z-type z-genconfig">server </span>{
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">listen</span> </span><span class="z-constant z-numeric z-genconfig">80</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">server_name</span> </span>mywebsite<span class="z-keyword z-operator z-genconfig">.</span>com www<span class="z-keyword z-operator z-genconfig">.</span>mywebsite<span class="z-keyword z-operator z-genconfig">.</span>com;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-keyword z-other z-genconfig">    location</span> <span class="z-keyword z-operator z-genconfig">/</span> {
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">root</span> </span><span class="z-keyword z-operator z-genconfig">/</span>path<span class="z-keyword z-operator z-genconfig">/</span>to<span class="z-keyword z-operator z-genconfig">/</span>your<span class="z-keyword z-operator z-genconfig">/</span>project;
</span><span class="z-source z-genconfig"><span class="z-keyword z-other z-genconfig">        index</span> index<span class="z-keyword z-operator z-genconfig">.</span>html index<span class="z-keyword z-operator z-genconfig">.</span>htm;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">default_type</span> </span><span class="z-string z-quoted z-double z-genconfig">"text/html"</span>;
</span><span class="z-source z-genconfig">    }
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">access_log</span> </span><span class="z-keyword z-operator z-genconfig">/</span>var<span class="z-keyword z-operator z-genconfig">/</span>log<span class="z-keyword z-operator z-genconfig">/</span>nginx<span class="z-keyword z-operator z-genconfig">/</span>mywebsite_access<span class="z-keyword z-operator z-genconfig">.</span>log;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">error_log</span> </span><span class="z-keyword z-operator z-genconfig">/</span>var<span class="z-keyword z-operator z-genconfig">/</span>log<span class="z-keyword z-operator z-genconfig">/</span>nginx<span class="z-keyword z-operator z-genconfig">/</span>mywebsite_errors<span class="z-keyword z-operator z-genconfig">.</span>log;
</span><span class="z-source z-genconfig">}
</span></code></pre><p>If you're not familiar with Nginx, let me explain what you just copied.<ol><li>We created a server block to hold our configuration and keep it separate from other configs we may add in the future (like https for example).<li>We declare the listen directive which tells nginx to listen on port 80.<li>We set the server_name to our domain name. This tells nginx to apply the config settings to any incoming request from any of listed urls.<li>Finally, we specify the paths to both the access and error logs. It's optional but highly recommended, so that you know exactly where to look when errors happen. This will save you a tonne of time when troubleshooting issues in the future.</ol><p>Close the file and exit nano or vim.<p>Nginx keeps its configuration files in two separate directories: <code>/etc/nginx/sites-available</code> and <code>/etc/nginx/sites-enabled</code>. It will serve any website whose configuration file is in the latter folder.<p>All you have to do now is create a symlink (think of it like a shortcut to an app in a desktop GUI) to your config, and store it in <code>sites-enabled</code>. That way, if you ever decide to shut down the site, you'll simply need to delete the symlink and you're good.<p>Before creating the symlink, it's good measure to check if the configuration file has any errors in it. To check for errors just run the following command:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> nginx<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>t</span></span>
</span></code></pre><p>It will scan all of your config files and check for errors (and return them to you if there are any).<p>Now you can create the symlink by executing:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> ln<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span> /etc/nginx/sites-available/mywebsite /etc/nginx/sites-enabled</span>
</span></code></pre><p><em>Note: If you decide to use service workers with your project and you're still running into caching issues, you should know that Nginx can also be used as a static assets server. I haven't looked into this scenario yet. I might test that approach in the future and detail the process in another post.</em><p>Lastly, reload nginx and your website should now be accessible via its URL (provided you correctly setup the DNS settings with your domain name registrar)<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> service nginx reload</span>
</span></code></pre><p>If you read this article all the way through, thanks for sticking with me ! You can send me questions, remarks, or comments on twitter, I'm <a rel="noopener nofollow noreferrer" href=https://twitter.com/aaqaishtyaq target=_blank>@aaqaishtyaq</a> on twitter.</div></article></main><footer><div class=border></div><div class=footer><small class=footer-left> Copyright Â© Aaqa Ishtyaq </small><small class=footer-right> Links: <a href=https://github.com/aaqaishtyaq target=_blank>Github</a> | <a href=https://linkedin.com/in/aaqaishtyaq target=_blank>LinkedIn</a> </small></div><br><small class=footer> <a class=pgp href=https://keys.openpgp.org/vks/v1/by-fingerprint/AFB766F59A198D35DD8F925AC4BE1CE588EB9E21 target=_blank> AFB7 66F5 9A19 8D35 DD8F 925A C4BE 1CE5 88EB 9E21 </a> </small></footer></div>